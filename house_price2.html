<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
	<style type="text/css">
		body, html {width: 100%;height: 100%;margin:0;font-family:"微软雅黑";}
		#allmap{width:100%;height:100%;}
		p{margin-left:5px; font-size:14px;}
	</style>
	<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=OaUTnl8sfMCC0twGBzaSlH4MIPLYyuaV"></script>
	<title>添加自定义覆盖物</title>
</head>
<body>
	<div id="allmap"></div>
</body>
</html>
<script type="text/javascript">
var  data = /*la			lo			name		price	rate	change*/[['32.309413', '118.316656', '亚龙名城', '5255', '-35.33%', '-2871'], ['32.339085', '118.335543', '景臣一品', '7062', '-17.30%', '-1477'], ['32.307611', '118.323072', '宝塔花园', '7413', '-15.90%', '-1401'], ['32.334554', '118.33289', '雨润星雨华府', '9573', '-9.10%', '-958'], ['32.307363', '118.319843', '立业小区', '6739', '-12.15%', '-932'], ['32.316006', '118.327459', '裕熙苑', '5892', '-11.37%', '-756'], ['32.308773', '118.334569', '凤凰三村', '6510', '-9.18%', '-658'], ['32.313996', '118.375533', '北京城建·国誉锦城', '5914', '-9.03%', '-587'], ['32.305235', '118.323569', '广场家园', '7939', '-4.68%', '-390'], ['32.309567', '118.328492', '学府名苑', '11382', '-3.16%', '-372'], ['32.308416', '118.330603', '凤凰小区一村', '5963', '-5.87%', '-372'], ['32.306231', '118.310785', '红叶山庄', '7194', '-4.84%', '-366'], ['32.29943', '118.314806', '铜欣雅居', '7823', '-4.17%', '-340'], ['32.306329', '118.333418', '凤凰四村', '6229', '-5.06%', '-332'], ['32.247162', '118.339847', '港汇中心', '7366', '-4.10%', '-315'], ['32.191314', '118.415704', '碧桂园·十里春风', '5916', '-4.89%', '-304'], ['32.295742', '118.319375', '丰乐世家', '6953', '-4.16%', '-302'], ['32.29741', '118.312417', '铜欣花园', '6948', '-4.17%', '-302'], ['32.346098', '118.350744', '菱溪苑', '4504', '-6.28%', '-302'], ['32.190342', '118.45558', '碧桂园·晚亭印象', '5694', '-4.86%', '-291'], ['32.301113', '118.30528', '铜矿北村', '5321', '-4.91%', '-275'], ['32.324827', '118.312634', '新兴花园', '5674', '-4.57%', '-272'], ['32.297959', '118.316336', '丰乐山庄', '6725', '-3.54%', '-247'], ['32.312844', '118.31168', '怡景园小区', '5767', '-4.08%', '-245'], ['32.262519', '118.312682', '君安阳光地中海', '8927', '-2.63%', '-241'], ['32.308518', '118.313288', '嘉宇万豪名苑', '8148', '-2.81%', '-236'], ['32.320643', '118.319165', '机关南苑', '5968', '-3.56%', '-220'], ['32.299211', '118.332237', '香樟花园', '7383', '-2.59%', '-196'], ['32.266119', '118.318518', '浩然国际', '8231', '-2.28%', '-192'], ['32.312023', '118.339866', '阳光河畔', '5163', '-3.41%', '-182'], ['32.313749', '118.314276', '明乐苑', '7594', '-2.33%', '-181'], ['32.268951', '118.315954', '永鑫金色春天', '8504', '-1.99%', '-173'], ['32.279543', '118.331893', '裕坤丽晶城', '7362', '-2.13%', '-160'], ['32.294662', '118.312152', '三盛颐景御园', '8775', '-1.75%', '-156'], ['32.311528', '118.317901', '世纪商业园', '5937', '-2.40%', '-146'], ['32.256586', '118.321499', '龙蟠东苑', '6221', '-2.17%', '-138'], ['32.314406', '118.327094', '置业花苑', '6425', '-2.01%', '-132'], ['32.317122', '118.328694', '光明园', '5757', '-2.03%', '-119'], ['32.275561', '118.317781', '山水人家', '7139', '-1.53%', '-111'], ['32.323459', '118.374131', '中州国际广场', '6158', '-1.65%', '-103'], ['32.281965', '118.350518', '天乐小区南区', '6023', '-1.41%', '-86'], ['32.247171', '118.321049', '名儒园', '6344', '-1.32%', '-85'], ['32.318523', '118.307709', '丰乐园', '6280', '-1.27%', '-81'], ['32.268351', '118.349424', '卓耕天御', '7979', '-0.98%', '-79'], ['32.293735', '118.327256', '银花西区', '6185', '-1.13%', '-71'], ['32.276276', '118.342421', '中旭都市名苑', '7649', '-0.89%', '-69'], ['32.309497', '118.333401', '凤凰小区二村', '5992', '-1.04%', '-63'], ['32.32448', '118.375079', '菊香园', '5840', '-1.07%', '-63'], ['32.310763', '118.369804', '清流人家', '5022', '-1.18%', '-60'], ['32.282896', '118.329523', '蓝天西区', '5937', '-0.97%', '-58'], ['32.302743', '118.319684', '竹锦北苑', '7669', '-0.72%', '-56'], ['32.307399', '118.315994', '丰乐花园', '5476', '-0.98%', '-54'], ['32.271308', '118.314574', '长乐小区', '6107', '-0.70%', '-43'], ['32.293634', '118.330211', '银花新村', '5935', '-0.69%', '-41'], ['32.286549', '118.329142', '银河小区', '7782', '-0.50%', '-39'], ['32.320596', '118.37801', '东菱城市新地', '5625', '-0.69%', '-39'], ['32.181014', '118.438151', '皖投碧湖云溪', '6872', '-0.32%', '-22'], ['32.306664', '118.317709', '静心花园', '6047', '-0.36%', '-22'], ['32.301114', '118.329618', '汇鑫大成国际', '7962', '-0.26%', '-21'], ['32.305556', '118.315831', '三里亭人家', '6646', '-0.31%', '-21'], ['32.305556', '118.315831', '三里亭人家', '6646', '-0.31%', '-21'], ['32.313996', '118.375533', '北京城建·珑樾华府', '6010', '-0.30%', '-18'], ['32.253895', '118.349543', '恒大绿洲', '8579', '-0.17%', '-15'], ['32.312018', '118.316169', '泰鑫中环国际广场', '7377', '-0.07%', '-5'], ['32.315111', '118.336279', '创业北苑', '5117', '-0.08%', '-4'], ['32.314513', '118.361687', '大唐菱湖御庭', '5999', '-0.02%', '-1'], ['32.294601', '118.341513', '盛世华庭怡园', '7165', '0.00%', '0'], ['32.770634', '118.030196', '桂花苑', '6560', '0.00%', '0'], ['32.310443', '118.314039', '天龙小区', '6178', '0.00%', '0'], ['32.296899', '118.316464', '润芳园', '6515', '0.12%', '8'], ['32.28001', '118.335425', '安康苑', '7239', '0.15%', '11'], ['32.183985', '118.415487', '富力乌衣水镇', '6678', '0.18%', '12'], ['32.346524', '118.331044', '融盛·观邸', '6149', '0.26%', '16'], ['32.299204', '118.319312', '丰泽茗园', '6554', '0.28%', '18'], ['32.260877', '118.317951', '金鹏99广场', '8036', '0.24%', '19'], ['32.283399', '118.350637', '天乐小区北区', '5404', '0.41%', '22'], ['32.25522', '118.33807', '世贸大厦', '5526', '0.51%', '28'], ['32.295363', '118.314819', '津乐园', '5842', '0.69%', '40'], ['32.295884', '118.326627', '泰鑫城市星座', '7611', '0.63%', '48'], ['32.288589', '118.332464', '成业家园', '6763', '0.74%', '50'], ['32.337296', '118.335773', '恩德广场', '6300', '0.80%', '50'], ['32.204701', '118.427869', '恒大江北帝景', '6023', '0.85%', '51'], ['32.203489', '118.417003', '碧桂园北岸世家', '6612', '0.81%', '53'], ['32.252164', '118.321123', '龙蟠南苑', '6885', '0.81%', '55'], ['32.261354', '118.329228', '天逸华府杏园', '8618', '0.71%', '61'], ['32.27865', '118.351622', '凯迪融创·玉兰公馆', '7555', '0.81%', '61'], ['32.290255', '118.344537', '盛世华庭熙园', '7105', '0.87%', '61'], ['32.292667', '118.321974', '御天下', '8712', '0.72%', '62'], ['32.330349', '118.332913', '国兴·翡翠湾', '6393', '1.00%', '63'], ['32.262392', '118.344618', '高速东方天地', '8503', '0.76%', '64'], ['32.276791', '118.332924', '恒大名都', '8489', '0.78%', '66'], ['32.277999', '118.326045', '七彩世界欢乐城', '7187', '0.97%', '69'], ['32.311449', '118.352865', '清流水韵', '6512', '1.07%', '69'], ['32.281637', '118.325067', '天安都市花园西区', '7630', '0.94%', '71'], ['32.291906', '118.316972', '水岸帝景', '7840', '0.94%', '73'], ['32.308003', '118.347132', '恒地滨河名园', '6400', '1.19%', '75'], ['32.329835', '118.311061', '北湖小区', '5209', '1.54%', '79'], ['32.209761', '118.420888', '菊香苑', '5559', '1.48%', '81'], ['32.299104', '118.373484', '珠江·和院', '6250', '1.36%', '84'], ['32.308646', '118.321247', '水石嘉园', '7247', '1.23%', '88'], ['32.343922', '118.333068', '鸿坤理想城', '6984', '1.28%', '88'], ['32.314185', '118.316001', '南湖花园', '6683', '1.33%', '88'], ['32.319847', '118.311531', '鼓楼花园', '5328', '1.72%', '90'], ['32.26867', '118.313208', '南都华府', '8207', '1.15%', '93'], ['32.312736', '118.309552', '滨湖小区', '6767', '1.47%', '98'], ['32.304512', '118.322961', '明悦园', '7602', '1.33%', '100'], ['32.257764', '118.327363', '凯迪塞纳河畔', '7905', '1.33%', '104'], ['32.298124', '118.320777', '紫薇西区', '6257', '1.77%', '109'], ['32.265846', '118.344227', '正东中央公馆', '8648', '1.49%', '127'], ['32.26255', '118.334223', '天逸华府桂园', '8678', '1.52%', '130'], ['32.302458', '118.336695', '紫薇东区', '6621', '2.18%', '141'], ['32.281761', '118.343958', '天安世纪城', '6696', '2.32%', '152'], ['32.292267', '118.319414', '凤翔苑', '7096', '2.32%', '161'], ['32.257773', '118.334234', '发能国际城', '8456', '2.00%', '166'], ['32.29304', '118.324598', '水银山庄', '6523', '2.64%', '168'], ['32.309145', '118.337376', '宏欣园小区', '5905', '2.96%', '170'], ['32.105353', '118.278556', '电厂宿舍', '5734', '3.07%', '171'], ['32.268428', '118.344985', '发能凤凰城', '7814', '2.41%', '184'], ['32.317891', '118.313765', '兴隆花园', '6114', '3.14%', '186'], ['32.326438', '118.348727', '扬子花园', '6173', '3.19%', '191'], ['32.3406', '118.336515', '益林铭府', '6384', '3.43%', '212'], ['32.305769', '118.322029', '泰鑫现代城', '9285', '2.40%', '218'], ['32.207707', '118.416869', '银润金陵赋', '5630', '4.20%', '227'], ['32.323307', '118.316849', '榴园新村', '6362', '4.16%', '254'], ['32.324097', '118.377961', '中州国际花园', '6261', '4.35%', '261'], ['32.261251', '118.325793', '天逸华府竹园', '9036', '3.00%', '263'], ['32.349541', '118.332902', '易景凯旋城', '7348', '3.79%', '268'], ['32.307654', '118.302456', '龙池花园', '5863', '4.85%', '271'], ['32.302075', '118.327531', '明珠园', '7525', '3.75%', '272'], ['32.289496', '118.364694', '创业南苑', '5207', '5.60%', '276'], ['32.303247', '118.32016', '农科所宿舍', '6646', '4.40%', '280'], ['32.302258', '118.315304', '书香门第', '8581', '3.56%', '295'], ['32.294613', '118.319971', '百合花园', '8691', '3.56%', '299'], ['32.25454', '118.346593', '鑫缘英仕公馆', '8718', '3.66%', '308'], ['32.308329', '118.328098', '康乐花园', '7912', '4.26%', '323'], ['32.282718', '118.326953', '天安都市花园东区', '7675', '4.39%', '323'], ['32.265693', '118.350564', '胜锦尚城国际', '7702', '5.05%', '370'], ['32.341516', '118.35271', '银花尚城', '5771', '7.45%', '400'], ['32.321473', '118.374366', '聚诚·雍德府', '5950', '7.42%', '411'], ['32.27256', '118.325005', '宇业富春园', '8040', '5.57%', '424'], ['32.319498', '118.323419', '南湖1号', '8475', '5.32%', '428'], ['32.314828', '118.353226', '申城金域豪庭', '7233', '7.30%', '492'], ['32.322386', '118.323379', '金叶一村', '6731', '8.18%', '509'], ['32.263467', '118.322318', '文昌花园', '8426', '6.52%', '516'], ['32.303408', '118.313102', '安居苑', '4994', '11.65%', '521'], ['32.299932', '118.306748', '深秀园小区', '8412', '6.97%', '548'], ['32.301896', '118.346418', '创业中苑', '5591', '11.00%', '554'], ['32.318918', '118.31311', '金色河畔', '7803', '8.24%', '594'], ['32.249172', '118.343299', '北京城建·珑熙庄园', '7819', '8.57%', '617'], ['32.272253', '118.322929', '清流警苑', '6869', '10.03%', '626'], ['32.295537', '118.316915', '凤凰湖畔', '7658', '9.51%', '665'], ['32.309803', '118.311482', '碧桂园皖投中央名邸', '9282', '7.96%', '684'], ['32.301991', '118.318624', '竹锦佳园', '6822', '11.58%', '708'], ['32.253939', '118.339885', '滁州世界贸易广场', '7457', '13.16%', '867'], ['32.302458', '118.336695', '紫薇园', '7463', '16.19%', '1040'], ['32.270052', '118.361507', '龙山小区', '6719', '20.72%', '1153'], ['32.312152', '118.325553', '新苑小区', '8245', '25.95%', '1699']];

  var min = 999999;
  var max = 0;
  for (var i=0; i<data.length; i++) {
    var pos = data[i];
    var price = +pos[3];
    var rate = +pos[4];
    var change = +pos[5];
    if (price > max) {max = price;}
    if (price < min) {min = price;}
  }
  max = max/2;
  var diff = max - min;
  var mid = (min+max)/1.5;
  console.log(min, max, diff);
  
  // 百度地图API功能
	var mp = new BMap.Map("allmap");
	mp.centerAndZoom("滁州", 15);
	mp.enableScrollWheelZoom();
	// 复杂的自定义覆盖物
    function ComplexCustomOverlay(point, text, text1, text2){
      this._point = point;
      this._text = text+" "+text1;//+" "+text2;
      this._price = +text1;
      this._change = +text2;
    }
    ComplexCustomOverlay.prototype = new BMap.Overlay();
    ComplexCustomOverlay.prototype.initialize = function(map){
      this._map = map;

      var r = 0;
      var g = 0;
      var b = 0;

      if (this._price < mid) {
        r = parseInt(255*(1-(this._price - min)/diff/2));
        g = 255;
        b = 0;
      } else {
        r = 255;
        g = parseInt(255*(1-(this._price - mid)/diff/2));
        b = 0;
      }

      var cc = "rgb("+r+","+g+","+b+")";
      var div = this._div = document.createElement("div");
      div.style.position = "absolute";
      div.style.zIndex = BMap.Overlay.getZIndex(this._point.lat);
      div.style.backgroundColor = cc;//"#EE5D5B";
//      div.style.border = "1px solid #BC3B3A";
      div.style.color = "black";
      div.style.height = "18px";
      div.style.padding = "2px";
      div.style.lineHeight = "18px";
      div.style.whiteSpace = "nowrap";
      div.style.MozUserSelect = "none";
      div.style.fontSize = "12px"
      var span = this._span = document.createElement("span");
      div.appendChild(span);
      span.appendChild(document.createTextNode(this._text));      
      var that = this;

      var arrow = this._arrow = document.createElement("div");
      arrow.style.background = "url(http://map.baidu.com/fwmap/upload/r/map/fwmap/static/house/images/label.png) no-repeat";
      arrow.style.position = "absolute";
      arrow.style.width = "11px";
      arrow.style.height = "10px";
      arrow.style.top = "22px";
      arrow.style.left = "10px";
      arrow.style.overflow = "hidden";
//      div.appendChild(arrow);
     
  /*    div.onmouseover = function(){
        this.style.backgroundColor = "#6BADCA";
        this.style.borderColor = "#0000ff";
        this.getElementsByTagName("span")[0].innerHTML = that._overText;
        arrow.style.backgroundPosition = "0px -20px";
      }

      div.onmouseout = function(){
        this.style.backgroundColor = "#EE5D5B";
        this.style.borderColor = "#BC3B3A";
        this.getElementsByTagName("span")[0].innerHTML = that._text;
        arrow.style.backgroundPosition = "0px 0px";
      }
*/
      mp.getPanes().labelPane.appendChild(div);
      
      return div;
    }
    ComplexCustomOverlay.prototype.draw = function(){
      var map = this._map;
      var pixel = map.pointToOverlayPixel(this._point);
      this._div.style.left = pixel.x - parseInt(this._arrow.style.left) + "px";
      this._div.style.top  = pixel.y - 30 + "px";
    }
        
    for (var i=0; i<data.length; i++) {
      var pos = data[i];
    	var myCompOverlay = new ComplexCustomOverlay(new BMap.Point(pos[1],pos[0]), pos[2],pos[3], pos[5]);

	    mp.addOverlay(myCompOverlay);
    }

</script>

